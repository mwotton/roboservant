name: Stack CI

on:
  pull_request:
  push:

jobs:
  stack:
    name: ${{ matrix.os }}-${{ matrix.ghc }}-stack
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        stack: ["3.7.1"]
        ghc: ["9.8.2", "9.6.5", "9.4.8"]
        os: [ubuntu-latest]
    steps:
      - uses: actions/checkout@v4

      - uses: haskell/actions/setup@v2
        name: Setup Haskell Stack
        with:
          ghc-version: ${{ matrix.ghc }}
          stack-version: ${{ matrix.stack }}
          enable-stack: true

      - name: Cache ~/.stack
        uses: actions/cache@v4
        with:
          path: ~/.stack
          key: ${{ runner.os }}-${{ matrix.ghc }}-stack-${{ matrix.stack }}

      - name: Test
        run: stack test
